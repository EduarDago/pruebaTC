€
]G:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\ConexionTablero.cs
	namespace 	

Proteccion
 
. 
TableroControl #
.# $
Datos$ )
.) *
DAO* -
{		 
public

 

abstract

 
class

 
ConexionTablero

 )
{ 
	protected 
Database 
Contexto #
;# $
	protected 
ConexionTablero !
(! "
IConfiguration" 0
config1 7
)7 8
{ 	
string 
connectionString #
=$ %
config& ,
., -
GetConnectionString- @
(@ A
$strA Q
)Q R
;R S
Contexto 
= 
new 
SqlDatabase &
(& '
connectionString' 7
)7 8
;8 9
} 	
} 
} ⁄“
fG:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\ConfiguracionOrigenDatos.cs
	namespace		 	

Proteccion		
 
.		 
TableroControl		 #
.		# $
Datos		$ )
.		) *
DAO		* -
{

 
public 

class $
ConfiguracionOrigenDatos )
:* +
ConexionTablero, ;
{ 
public $
ConfiguracionOrigenDatos '
(' (
IConfiguration( 6
config7 =
)= >
:? @
baseA E
(E F
configF L
)L M
{ 	
} 	
public 
List 
< 
ConfiguracionOrigen '
>' ((
ObtenerConfiguracionesOrigen) E
(E F
)F G
{ 	
using 
( 
	DbCommand 
cmd  
=! "
Contexto# +
.+ , 
GetStoredProcCommand, @
(@ A
$strA o
)o p
)p q
{ 
var 
listado 
= 
new !
List" &
<& '
ConfiguracionOrigen' :
>: ;
(; <
)< =
;= >
using 
( 
var 
reader !
=" #
Contexto$ ,
., -
ExecuteReader- :
(: ;
cmd; >
)> ?
)? @
{ 
while 
( 
reader !
.! "
Read" &
(& '
)' (
)( )
{ 
var   
configuracion   )
=  * +
new  , /
ConfiguracionOrigen  0 C
(  C D
)  D E
;  E F
configuracion!! %
.!!% &
IdConfiguracion!!& 5
=!!6 7
Convert!!8 ?
.!!? @
ToInt32!!@ G
(!!G H
reader!!H N
[!!N O
$str!!O f
]!!f g
.!!g h
ToString!!h p
(!!p q
)!!q r
)!!r s
;!!s t
configuracion"" %
.""% &
Nombre""& ,
=""- .
reader""/ 5
[""5 6
$str""6 >
]""> ?
.""? @
ToString""@ H
(""H I
)""I J
;""J K
configuracion## %
.##% &
Descripcion##& 1
=##2 3
reader##4 :
[##: ;
$str##; H
]##H I
.##I J
ToString##J R
(##R S
)##S T
;##T U
configuracion$$ %
.$$% &
Procedimiento$$& 3
=$$4 5
reader$$6 <
[$$< =
$str$$= L
]$$L M
.$$M N
ToString$$N V
($$V W
)$$W X
;$$X Y
configuracion%% %
.%%% &
NombreTabla%%& 1
=%%2 3
reader%%4 :
[%%: ;
$str%%; H
]%%H I
.%%I J
ToString%%J R
(%%R S
)%%S T
;%%T U
listado'' 
.''  
Add''  #
(''# $
configuracion''$ 1
)''1 2
;''2 3
}(( 
})) 
return++ 
listado++ 
;++ 
},, 
}-- 	
public33 
ConfiguracionOrigen33 "&
ObtenerConfiguracionOrigen33# =
(33= >
int33> A
idConfiguracion33B Q
)33Q R
{44 	
using55 
(55 
	DbCommand55 
cmd55  
=55! "
Contexto55# +
.55+ , 
GetStoredProcCommand55, @
(55@ A
$str55A m
)55m n
)55n o
{66 
Contexto77 
.77 
AddInParameter77 '
(77' (
cmd77( +
,77+ ,
$str77- ?
,77? @
DbType77A G
.77G H
Int3277H M
,77M N
idConfiguracion77O ^
)77^ _
;77_ `
ConfiguracionOrigen99 #
configuracion99$ 1
=992 3
null994 8
;998 9
using;; 
(;; 
var;; 
reader;; !
=;;" #
Contexto;;$ ,
.;;, -
ExecuteReader;;- :
(;;: ;
cmd;;; >
);;> ?
);;? @
{<< 
if== 
(== 
reader== 
.== 
Read== "
(==" #
)==# $
)==$ %
{>> 
configuracion?? %
=??& '
new??( +
ConfiguracionOrigen??, ?
(??? @
)??@ A
;??A B
configuracion@@ %
.@@% &
IdConfiguracion@@& 5
=@@6 7
Convert@@8 ?
.@@? @
ToInt32@@@ G
(@@G H
reader@@H N
[@@N O
$str@@O f
]@@f g
.@@g h
ToString@@h p
(@@p q
)@@q r
)@@r s
;@@s t
configuracionAA %
.AA% &
NombreAA& ,
=AA- .
readerAA/ 5
[AA5 6
$strAA6 >
]AA> ?
.AA? @
ToStringAA@ H
(AAH I
)AAI J
;AAJ K
configuracionBB %
.BB% &
DescripcionBB& 1
=BB2 3
readerBB4 :
[BB: ;
$strBB; H
]BBH I
.BBI J
ToStringBBJ R
(BBR S
)BBS T
;BBT U
configuracionCC %
.CC% &
ProcedimientoCC& 3
=CC4 5
readerCC6 <
[CC< =
$strCC= L
]CCL M
.CCM N
ToStringCCN V
(CCV W
)CCW X
;CCX Y
configuracionDD %
.DD% &
NombreTablaDD& 1
=DD2 3
readerDD4 :
[DD: ;
$strDD; H
]DDH I
.DDI J
ToStringDDJ R
(DDR S
)DDS T
;DDT U
configuracionEE %
.EE% &

ParametrosEE& 0
=EE1 2#
ObtenerParametrosOrigenEE3 J
(EEJ K
idConfiguracionEEK Z
)EEZ [
;EE[ \
configuracionFF %
.FF% &
CamposFF& ,
=FF- .
ObtenerCamposOrigenFF/ B
(FFB C
idConfiguracionFFC R
)FFR S
;FFS T
}GG 
}HH 
returnJJ 
configuracionJJ $
;JJ$ %
}KK 
}LL 	
publicRR 
ListRR 
<RR 
ParametroOrigenRR #
>RR# $#
ObtenerParametrosOrigenRR% <
(RR< =
intRR= @
idConfiguracionRRA P
)RRP Q
{SS 	
usingTT 
(TT 
	DbCommandTT 
cmdTT  
=TT! "
ContextoTT# +
.TT+ , 
GetStoredProcCommandTT, @
(TT@ A
$strTTA j
)TTj k
)TTk l
{UU 
ContextoVV 
.VV 
AddInParameterVV '
(VV' (
cmdVV( +
,VV+ ,
$strVV- ?
,VV? @
DbTypeVVA G
.VVG H
Int32VVH M
,VVM N
idConfiguracionVVO ^
)VV^ _
;VV_ `
varWW 
listadoWW 
=WW 
newWW !
ListWW" &
<WW& '
ParametroOrigenWW' 6
>WW6 7
(WW7 8
)WW8 9
;WW9 :
usingYY 
(YY 
varYY 
readerYY !
=YY" #
ContextoYY$ ,
.YY, -
ExecuteReaderYY- :
(YY: ;
cmdYY; >
)YY> ?
)YY? @
{ZZ 
while[[ 
([[ 
reader[[ !
.[[! "
Read[[" &
([[& '
)[[' (
)[[( )
{\\ 
var]] 
	parametro]] %
=]]& '
new]]( +
ParametroOrigen]], ;
(]]; <
)]]< =
;]]= >
	parametro^^ !
.^^! "
Id^^" $
=^^% &
Convert^^' .
.^^. /
ToInt32^^/ 6
(^^6 7
reader^^7 =
[^^= >
$str^^> B
]^^B C
.^^C D
ToString^^D L
(^^L M
)^^M N
)^^N O
;^^O P
	parametro__ !
.__! "
IdConfiguracion__" 1
=__2 3
Convert__4 ;
.__; <
ToInt32__< C
(__C D
reader__D J
[__J K
$str__K b
]__b c
.__c d
ToString__d l
(__l m
)__m n
)__n o
;__o p
	parametro`` !
.``! "
Nombre``" (
=``) *
reader``+ 1
[``1 2
$str``2 :
]``: ;
.``; <
ToString``< D
(``D E
)``E F
;``F G
	parametroaa !
.aa! "
TipoDatoaa" *
=aa+ ,
readeraa- 3
[aa3 4
$straa4 >
]aa> ?
.aa? @
ToStringaa@ H
(aaH I
)aaI J
;aaJ K
listadocc 
.cc  
Addcc  #
(cc# $
	parametrocc$ -
)cc- .
;cc. /
}dd 
}ee 
returngg 
listadogg 
;gg 
}hh 
}ii 	
publicoo 
Listoo 
<oo 
CampoOrigenoo 
>oo  
ObtenerCamposOrigenoo! 4
(oo4 5
intoo5 8
idConfiguracionoo9 H
)ooH I
{pp 	
usingqq 
(qq 
	DbCommandqq 
cmdqq  
=qq! "
Contextoqq# +
.qq+ , 
GetStoredProcCommandqq, @
(qq@ A
$strqqA f
)qqf g
)qqg h
{rr 
Contextoss 
.ss 
AddInParameterss '
(ss' (
cmdss( +
,ss+ ,
$strss- ?
,ss? @
DbTypessA G
.ssG H
Int32ssH M
,ssM N
idConfiguracionssO ^
)ss^ _
;ss_ `
vartt 
listadott 
=tt 
newtt !
Listtt" &
<tt& '
CampoOrigentt' 2
>tt2 3
(tt3 4
)tt4 5
;tt5 6
usingvv 
(vv 
varvv 
readervv !
=vv" #
Contextovv$ ,
.vv, -
ExecuteReadervv- :
(vv: ;
cmdvv; >
)vv> ?
)vv? @
{ww 
whilexx 
(xx 
readerxx !
.xx! "
Readxx" &
(xx& '
)xx' (
)xx( )
{yy 
varzz 
campozz !
=zz" #
newzz$ '
CampoOrigenzz( 3
(zz3 4
)zz4 5
;zz5 6
campo{{ 
.{{ 
Id{{  
={{! "
Convert{{# *
.{{* +
ToInt32{{+ 2
({{2 3
reader{{3 9
[{{9 :
$str{{: >
]{{> ?
.{{? @
ToString{{@ H
({{H I
){{I J
){{J K
;{{K L
campo|| 
.|| 
IdConfiguracion|| -
=||. /
Convert||0 7
.||7 8
ToInt32||8 ?
(||? @
reader||@ F
[||F G
$str||G ^
]||^ _
.||_ `
ToString||` h
(||h i
)||i j
)||j k
;||k l
campo}} 
.}} 
Nombre}} $
=}}% &
reader}}' -
[}}- .
$str}}. 6
]}}6 7
.}}7 8
ToString}}8 @
(}}@ A
)}}A B
;}}B C
campo~~ 
.~~ 
TipoDato~~ &
=~~' (
reader~~) /
[~~/ 0
$str~~0 :
]~~: ;
.~~; <
ToString~~< D
(~~D E
)~~E F
;~~F G
listado
ÄÄ 
.
ÄÄ  
Add
ÄÄ  #
(
ÄÄ# $
campo
ÄÄ$ )
)
ÄÄ) *
;
ÄÄ* +
}
ÅÅ 
}
ÇÇ 
return
ÑÑ 
listado
ÑÑ 
;
ÑÑ 
}
ÖÖ 
}
ÜÜ 	
public
åå 
List
åå 
<
åå "
EjecucionImportacion
åå (
>
åå( )"
ConsultarEjecuciones
åå* >
(
åå> ?
)
åå? @
{
çç 	
using
éé 
(
éé 
	DbCommand
éé 
cmd
éé  
=
éé! "
Contexto
éé# +
.
éé+ ,"
GetStoredProcCommand
éé, @
(
éé@ A
$str
ééA e
)
éée f
)
ééf g
{
èè 
var
êê 
listado
êê 
=
êê 
new
êê !
List
êê" &
<
êê& '"
EjecucionImportacion
êê' ;
>
êê; <
(
êê< =
)
êê= >
;
êê> ?
using
íí 
(
íí 
var
íí 
reader
íí !
=
íí" #
Contexto
íí$ ,
.
íí, -
ExecuteReader
íí- :
(
íí: ;
cmd
íí; >
)
íí> ?
)
íí? @
{
ìì 
while
îî 
(
îî 
reader
îî !
.
îî! "
Read
îî" &
(
îî& '
)
îî' (
)
îî( )
{
ïï 
var
ññ 
	ejecucion
ññ %
=
ññ& '
new
ññ( +"
EjecucionImportacion
ññ, @
(
ññ@ A
)
ññA B
;
ññB C
	ejecucion
óó !
.
óó! "
IdEjecucion
óó" -
=
óó. /
Convert
óó0 7
.
óó7 8
ToInt32
óó8 ?
(
óó? @
reader
óó@ F
[
óóF G
$str
óóG T
]
óóT U
.
óóU V
ToString
óóV ^
(
óó^ _
)
óó_ `
)
óó` a
;
óóa b
	ejecucion
òò !
.
òò! "#
IdConfiguracionOrigen
òò" 7
=
òò8 9
Convert
òò: A
.
òòA B
ToInt32
òòB I
(
òòI J
reader
òòJ P
[
òòP Q
$str
òòQ h
]
òòh i
.
òòi j
ToString
òòj r
(
òòr s
)
òòs t
)
òòt u
;
òòu v
	ejecucion
ôô !
.
ôô! "
NombreOrigen
ôô" .
=
ôô/ 0
reader
ôô1 7
[
ôô7 8
$str
ôô8 @
]
ôô@ A
.
ôôA B
ToString
ôôB J
(
ôôJ K
)
ôôK L
;
ôôL M
	ejecucion
öö !
.
öö! "
FechaEjecucion
öö" 0
=
öö1 2
Convert
öö3 :
.
öö: ;

ToDateTime
öö; E
(
ööE F
reader
ööF L
[
ööL M
$str
ööM ]
]
öö] ^
.
öö^ _
ToString
öö_ g
(
öög h
)
ööh i
)
ööi j
;
ööj k
	ejecucion
õõ !
.
õõ! "
Estado
õõ" (
=
õõ) *
reader
õõ+ 1
[
õõ1 2
$str
õõ2 :
]
õõ: ;
.
õõ; <
ToString
õõ< D
(
õõD E
)
õõE F
;
õõF G
	ejecucion
úú !
.
úú! "
CantidadRegistros
úú" 3
=
úú4 5
Convert
úú6 =
.
úú= >
ToInt32
úú> E
(
úúE F
reader
úúF L
[
úúL M
$str
úúM `
]
úú` a
.
úúa b
ToString
úúb j
(
úúj k
)
úúk l
)
úúl m
;
úúm n
listado
ûû 
.
ûû  
Add
ûû  #
(
ûû# $
	ejecucion
ûû$ -
)
ûû- .
;
ûû. /
}
üü 
}
†† 
return
¢¢ 
listado
¢¢ 
;
¢¢ 
}
££ 
}
§§ 	
public
´´ "
EjecucionImportacion
´´ #!
EjecutarImportacion
´´$ 7
(
´´7 8
int
´´8 ;
idConfiguracion
´´< K
)
´´K L
{
¨¨ 	
using
≠≠ 
(
≠≠ 
	DbCommand
≠≠ 
cmd
≠≠  
=
≠≠! "
Contexto
≠≠# +
.
≠≠+ ,"
GetStoredProcCommand
≠≠, @
(
≠≠@ A
$str
≠≠A f
)
≠≠f g
)
≠≠g h
{
ÆÆ 
cmd
ØØ 
.
ØØ 
CommandTimeout
ØØ "
=
ØØ# $
$num
ØØ% &
;
ØØ& '
Contexto
∞∞ 
.
∞∞ 
AddInParameter
∞∞ '
(
∞∞' (
cmd
∞∞( +
,
∞∞+ ,
$str
∞∞- ?
,
∞∞? @
DbType
∞∞A G
.
∞∞G H
Int32
∞∞H M
,
∞∞M N
idConfiguracion
∞∞O ^
)
∞∞^ _
;
∞∞_ `"
EjecucionImportacion
≤≤ $
	ejecucion
≤≤% .
=
≤≤/ 0
null
≤≤1 5
;
≤≤5 6
using
¥¥ 
(
¥¥ 
var
¥¥ 
reader
¥¥ !
=
¥¥" #
Contexto
¥¥$ ,
.
¥¥, -
ExecuteReader
¥¥- :
(
¥¥: ;
cmd
¥¥; >
)
¥¥> ?
)
¥¥? @
{
µµ 
if
∂∂ 
(
∂∂ 
reader
∂∂ 
.
∂∂ 
Read
∂∂ #
(
∂∂# $
)
∂∂$ %
)
∂∂% &
{
∑∑ 
	ejecucion
∏∏ !
=
∏∏" #
new
∏∏$ '"
EjecucionImportacion
∏∏( <
(
∏∏< =
)
∏∏= >
;
∏∏> ?
	ejecucion
∫∫ !
.
∫∫! "#
IdConfiguracionOrigen
∫∫" 7
=
∫∫8 9
idConfiguracion
∫∫: I
;
∫∫I J
	ejecucion
ªª !
.
ªª! "
Estado
ªª" (
=
ªª) *
reader
ªª+ 1
[
ªª1 2
$str
ªª2 :
]
ªª: ;
.
ªª; <
ToString
ªª< D
(
ªªD E
)
ªªE F
;
ªªF G
	ejecucion
ºº !
.
ºº! "
CantidadRegistros
ºº" 3
=
ºº4 5
Convert
ºº6 =
.
ºº= >
ToInt32
ºº> E
(
ººE F
reader
ººF L
[
ººL M
$str
ººM X
]
ººX Y
.
ººY Z
ToString
ººZ b
(
ººb c
)
ººc d
)
ººd e
;
ººe f
}
ΩΩ 
}
ææ 
return
¿¿ 
	ejecucion
¿¿  
;
¿¿  !
}
¡¡ 
}
¬¬ 	
public
…… 
bool
…… )
InsertarConfiguracionOrigen
…… /
(
……/ 0!
ConfiguracionOrigen
……0 C
configuracion
……D Q
)
……Q R
{
   	
using
ÀÀ 
(
ÀÀ 
	DbCommand
ÀÀ 
cmd
ÀÀ  
=
ÀÀ! "
Contexto
ÀÀ# +
.
ÀÀ+ ,"
GetStoredProcCommand
ÀÀ, @
(
ÀÀ@ A
$str
ÀÀA l
)
ÀÀl m
)
ÀÀm n
{
ÃÃ 
int
ÕÕ 
idConfiguracion
ÕÕ #
=
ÕÕ$ %
$num
ÕÕ& '
;
ÕÕ' (
Contexto
œœ 
.
œœ 
AddInParameter
œœ '
(
œœ' (
cmd
œœ( +
,
œœ+ ,
$str
œœ- 6
,
œœ6 7
DbType
œœ8 >
.
œœ> ?
String
œœ? E
,
œœE F
configuracion
œœG T
.
œœT U
Nombre
œœU [
)
œœ[ \
;
œœ\ ]
Contexto
–– 
.
–– 
AddInParameter
–– '
(
––' (
cmd
––( +
,
––+ ,
$str
––- ;
,
––; <
DbType
––= C
.
––C D
String
––D J
,
––J K
configuracion
––L Y
.
––Y Z
Descripcion
––Z e
)
––e f
;
––f g
Contexto
—— 
.
—— 
AddInParameter
—— '
(
——' (
cmd
——( +
,
——+ ,
$str
——- =
,
——= >
DbType
——? E
.
——E F
String
——F L
,
——L M
configuracion
——N [
.
——[ \
Procedimiento
——\ i
)
——i j
;
——j k
Contexto
““ 
.
““ 
AddInParameter
““ '
(
““' (
cmd
““( +
,
““+ ,
$str
““- ;
,
““; <
DbType
““= C
.
““C D
String
““D J
,
““J K
configuracion
““L Y
.
““Y Z
NombreTabla
““Z e
)
““e f
;
““f g
using
‘‘ 
(
‘‘ 
DbConnection
‘‘ #
conn
‘‘$ (
=
‘‘) *
Contexto
‘‘+ 3
.
‘‘3 4
CreateConnection
‘‘4 D
(
‘‘D E
)
‘‘E F
)
‘‘F G
{
’’ 
conn
÷÷ 
.
÷÷ 
Open
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷  
DbTransaction
◊◊ !
transaccion
◊◊" -
=
◊◊. /
conn
◊◊0 4
.
◊◊4 5
BeginTransaction
◊◊5 E
(
◊◊E F
)
◊◊F G
;
◊◊G H
try
ŸŸ 
{
⁄⁄ 
using
€€ 
(
€€ 
var
€€ "
reader
€€# )
=
€€* +
Contexto
€€, 4
.
€€4 5
ExecuteReader
€€5 B
(
€€B C
cmd
€€C F
)
€€F G
)
€€G H
{
‹‹ 
if
›› 
(
››  
reader
››  &
.
››& '
Read
››' +
(
››+ ,
)
››, -
)
››- .
{
ﬁﬁ 
idConfiguracion
ﬂﬂ  /
=
ﬂﬂ0 1
Convert
ﬂﬂ2 9
.
ﬂﬂ9 :
ToInt32
ﬂﬂ: A
(
ﬂﬂA B
reader
ﬂﬂB H
[
ﬂﬂH I
$str
ﬂﬂI M
]
ﬂﬂM N
.
ﬂﬂN O
ToString
ﬂﬂO W
(
ﬂﬂW X
)
ﬂﬂX Y
)
ﬂﬂY Z
;
ﬂﬂZ [
}
‡‡ 
}
·· 
foreach
„„ 
(
„„  !
var
„„! $
campo
„„% *
in
„„+ -
configuracion
„„. ;
.
„„; <
Campos
„„< B
)
„„B C
{
‰‰ 
campo
ÂÂ !
.
ÂÂ! "
IdConfiguracion
ÂÂ" 1
=
ÂÂ2 3
idConfiguracion
ÂÂ4 C
;
ÂÂC D!
InsertarCampoOrigen
ÊÊ /
(
ÊÊ/ 0
campo
ÊÊ0 5
)
ÊÊ5 6
;
ÊÊ6 7
}
ÁÁ 
foreach
ÈÈ 
(
ÈÈ  !
var
ÈÈ! $
	parametro
ÈÈ% .
in
ÈÈ/ 1
configuracion
ÈÈ2 ?
.
ÈÈ? @

Parametros
ÈÈ@ J
)
ÈÈJ K
{
ÍÍ 
	parametro
ÎÎ %
.
ÎÎ% &
IdConfiguracion
ÎÎ& 5
=
ÎÎ6 7
idConfiguracion
ÎÎ8 G
;
ÎÎG H%
InsertarParametroOrigen
ÏÏ 3
(
ÏÏ3 4
	parametro
ÏÏ4 =
)
ÏÏ= >
;
ÏÏ> ?
}
ÌÌ 
CrearEstructura
ÔÔ '
(
ÔÔ' (
idConfiguracion
ÔÔ( 7
)
ÔÔ7 8
;
ÔÔ8 9
transaccion
ÒÒ #
.
ÒÒ# $
Commit
ÒÒ$ *
(
ÒÒ* +
)
ÒÒ+ ,
;
ÒÒ, -
return
ÛÛ 
true
ÛÛ #
;
ÛÛ# $
}
ÙÙ 
catch
ıı 
{
ˆˆ 
transaccion
˜˜ #
.
˜˜# $
Rollback
˜˜$ ,
(
˜˜, -
)
˜˜- .
;
˜˜. /
return
¯¯ 
false
¯¯ $
;
¯¯$ %
}
˘˘ 
finally
˙˙ 
{
˚˚ 
conn
¸¸ 
.
¸¸ 
Close
¸¸ "
(
¸¸" #
)
¸¸# $
;
¸¸$ %
}
˝˝ 
}
˛˛ 
}
ˇˇ 
}
ÄÄ 	
private
áá 
void
áá !
InsertarCampoOrigen
áá (
(
áá( )
CampoOrigen
áá) 4
campo
áá5 :
)
áá: ;
{
àà 	
using
ââ 
(
ââ 
	DbCommand
ââ 
cmd
ââ  
=
ââ! "
Contexto
ââ# +
.
ââ+ ,"
GetStoredProcCommand
ââ, @
(
ââ@ A
$str
ââA d
)
ââd e
)
ââe f
{
ää 
Contexto
ãã 
.
ãã 
AddInParameter
ãã '
(
ãã' (
cmd
ãã( +
,
ãã+ ,
$str
ãã- E
,
ããE F
DbType
ããG M
.
ããM N
Int32
ããN S
,
ããS T
campo
ããU Z
.
ããZ [
IdConfiguracion
ãã[ j
)
ããj k
;
ããk l
Contexto
åå 
.
åå 
AddInParameter
åå '
(
åå' (
cmd
åå( +
,
åå+ ,
$str
åå- 6
,
åå6 7
DbType
åå8 >
.
åå> ?
String
åå? E
,
ååE F
campo
ååG L
.
ååL M
Nombre
ååM S
)
ååS T
;
ååT U
Contexto
çç 
.
çç 
AddInParameter
çç '
(
çç' (
cmd
çç( +
,
çç+ ,
$str
çç- 8
,
çç8 9
DbType
çç: @
.
çç@ A
String
ççA G
,
ççG H
campo
ççI N
.
ççN O
TipoDato
ççO W
)
ççW X
;
ççX Y
Contexto
èè 
.
èè 
ExecuteNonQuery
èè (
(
èè( )
cmd
èè) ,
)
èè, -
;
èè- .
}
êê 
}
ëë 	
private
òò 
void
òò %
InsertarParametroOrigen
òò ,
(
òò, -
ParametroOrigen
òò- <
	parametro
òò= F
)
òòF G
{
ôô 	
using
öö 
(
öö 
	DbCommand
öö 
cmd
öö  
=
öö! "
Contexto
öö# +
.
öö+ ,"
GetStoredProcCommand
öö, @
(
öö@ A
$str
ööA h
)
ööh i
)
ööi j
{
õõ 
Contexto
úú 
.
úú 
AddInParameter
úú '
(
úú' (
cmd
úú( +
,
úú+ ,
$str
úú- E
,
úúE F
DbType
úúG M
.
úúM N
Int32
úúN S
,
úúS T
	parametro
úúU ^
.
úú^ _
IdConfiguracion
úú_ n
)
úún o
;
úúo p
Contexto
ùù 
.
ùù 
AddInParameter
ùù '
(
ùù' (
cmd
ùù( +
,
ùù+ ,
$str
ùù- 6
,
ùù6 7
DbType
ùù8 >
.
ùù> ?
String
ùù? E
,
ùùE F
	parametro
ùùG P
.
ùùP Q
Nombre
ùùQ W
)
ùùW X
;
ùùX Y
Contexto
ûû 
.
ûû 
AddInParameter
ûû '
(
ûû' (
cmd
ûû( +
,
ûû+ ,
$str
ûû- 8
,
ûû8 9
DbType
ûû: @
.
ûû@ A
String
ûûA G
,
ûûG H
	parametro
ûûI R
.
ûûR S
TipoDato
ûûS [
)
ûû[ \
;
ûû\ ]
Contexto
†† 
.
†† 
ExecuteNonQuery
†† (
(
††( )
cmd
††) ,
)
††, -
;
††- .
}
°° 
}
¢¢ 	
private
©© 
void
©© 
CrearEstructura
©© $
(
©©$ %
int
©©% (
idConfiguracion
©©) 8
)
©©8 9
{
™™ 	
using
´´ 
(
´´ 
	DbCommand
´´ 
cmd
´´  
=
´´! "
Contexto
´´# +
.
´´+ ,"
GetStoredProcCommand
´´, @
(
´´@ A
$str
´´A `
)
´´` a
)
´´a b
{
¨¨ 
Contexto
≠≠ 
.
≠≠ 
AddInParameter
≠≠ '
(
≠≠' (
cmd
≠≠( +
,
≠≠+ ,
$str
≠≠- ?
,
≠≠? @
DbType
≠≠A G
.
≠≠G H
Int32
≠≠H M
,
≠≠M N
idConfiguracion
≠≠O ^
)
≠≠^ _
;
≠≠_ `
Contexto
ÆÆ 
.
ÆÆ 
ExecuteNonQuery
ÆÆ (
(
ÆÆ( )
cmd
ÆÆ) ,
)
ÆÆ, -
;
ÆÆ- .
}
ØØ 
}
∞∞ 	
}
±± 
}≤≤ ˜
YG:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\TopicoDatos.cs
	namespace		 	

Proteccion		
 
.		 
TableroControl		 #
.		# $
Datos		$ )
.		) *
DAO		* -
{

 
public 

class 
TopicoDatos 
: 
ConexionTablero .
{ 
public 
TopicoDatos 
( 
IConfiguration )
config* 0
)0 1
:2 3
base4 8
(8 9
config9 ?
)? @
{ 	
} 	
public 
List 
< 
Topico 
> 
ObtenerTopicos *
(* +
string+ 1
identificador2 ?
)? @
{ 	
using 
( 
	DbCommand 
cmd  
=! "
Contexto# +
.+ , 
GetStoredProcCommand, @
(@ A
$strA Z
)Z [
)[ \
{ 
Contexto 
. 
AddInParameter '
(' (
cmd( +
,+ ,
$str- =
,= >
DbType? E
.E F
StringF L
,L M
identificadorN [
)[ \
;\ ]
var 
listado 
= 
new !
List" &
<& '
Topico' -
>- .
(. /
)/ 0
;0 1
using 
( 
var 
reader !
=" #
Contexto$ ,
., -
ExecuteReader- :
(: ;
cmd; >
)> ?
)? @
{ 
while   
(   
reader   !
.  ! "
Read  " &
(  & '
)  ' (
)  ( )
{!! 
var"" 
topico"" "
=""# $
new""% (
Topico"") /
(""/ 0
)""0 1
;""1 2
topico## 
.## 
IdTopico## '
=##( )
Convert##* 1
.##1 2
ToInt32##2 9
(##9 :
reader##: @
[##@ A
$str##A K
]##K L
.##L M
ToString##M U
(##U V
)##V W
)##W X
;##X Y
topico$$ 
.$$ 
Identificador$$ ,
=$$- .
reader$$/ 5
[$$5 6
$str$$6 E
]$$E F
.$$F G
ToString$$G O
($$O P
)$$P Q
;$$Q R
topico%% 
.%% 
Valor%% $
=%%% &
reader%%' -
[%%- .
$str%%. 5
]%%5 6
.%%6 7
ToString%%7 ?
(%%? @
)%%@ A
;%%A B
topico&& 
.&& 
TextoMostrar&& +
=&&, -
reader&&. 4
[&&4 5
$str&&5 C
]&&C D
.&&D E
ToString&&E M
(&&M N
)&&N O
;&&O P
topico'' 
.'' 
Orden'' $
=''% &
Convert''' .
.''. /
ToInt32''/ 6
(''6 7
reader''7 =
[''= >
$str''> E
]''E F
.''F G
ToString''G O
(''O P
)''P Q
)''Q R
;''R S
listado)) 
.))  
Add))  #
())# $
topico))$ *
)))* +
;))+ ,
}** 
}++ 
return-- 
listado-- 
;-- 
}.. 
}// 	
}00 
}11 –Y
]G:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\ValidacionDatos.cs
	namespace 	

Proteccion
 
. 
TableroControl #
.# $
Datos$ )
.) *
DAO* -
{ 
public 

class 
ValidacionDatos  
:! "
ConexionTablero# 2
{ 
public 
ValidacionDatos 
( 
IConfiguration -
config. 4
)4 5
:6 7
base8 <
(< =
config= C
)C D
{ 	
} 	
public 
List 
< 

Validacion 
> 
ObtenerValidaciones  3
(3 4
)4 5
{ 	
using 
( 
	DbCommand 
cmd  
=! "
Contexto# +
.+ , 
GetStoredProcCommand, @
(@ A
$strA c
)c d
)d e
{ 
var 
listado 
= 
new !
List" &
<& '

Validacion' 1
>1 2
(2 3
)3 4
;4 5
using 
( 
var 
reader !
=" #
Contexto$ ,
., -
ExecuteReader- :
(: ;
cmd; >
)> ?
)? @
{   
while!! 
(!! 
reader!! !
.!!! "
Read!!" &
(!!& '
)!!' (
)!!( )
{"" 
var## 

validacion## &
=##' (
new##) ,

Validacion##- 7
(##7 8
)##8 9
;##9 :

validacion$$ "
.$$" #
IdValidacion$$# /
=$$0 1
Convert$$2 9
.$$9 :
ToInt32$$: A
($$A B
reader$$B H
[$$H I
$str$$I W
]$$W X
.$$X Y
ToString$$Y a
($$a b
)$$b c
)$$c d
;$$d e

validacion%% "
.%%" #
TipoValidacion%%# 1
=%%2 3
Convert%%4 ;
.%%; <
ToInt32%%< C
(%%C D
reader%%D J
[%%J K
$str%%K [
]%%[ \
.%%\ ]
ToString%%] e
(%%e f
)%%f g
)%%g h
;%%h i

validacion&& "
.&&" #
Descripcion&&# .
=&&/ 0
reader&&1 7
[&&7 8
$str&&8 E
]&&E F
.&&F G
ToString&&G O
(&&O P
)&&P Q
;&&Q R

validacion'' "
.''" #
Objetivo''# +
='', -
reader''. 4
[''4 5
$str''5 ?
]''? @
.''@ A
ToString''A I
(''I J
)''J K
;''K L

validacion(( "
.((" #
BaseDatosOrigen((# 2
=((3 4
reader((5 ;
[((; <
$str((< M
]((M N
.((N O
ToString((O W
(((W X
)((X Y
;((Y Z

validacion)) "
.))" #
TablaOrigen))# .
=))/ 0
reader))1 7
[))7 8
$str))8 E
]))E F
.))F G
ToString))G O
())O P
)))P Q
;))Q R

validacion** "
.**" #
Activo**# )
=*** +
Convert**, 3
.**3 4
	ToBoolean**4 =
(**= >
reader**> D
[**D E
$str**E M
]**M N
.**N O
ToString**O W
(**W X
)**X Y
)**Y Z
;**Z [
listado,, 
.,,  
Add,,  #
(,,# $

validacion,,$ .
),,. /
;,,/ 0
}-- 
}.. 
return00 
listado00 
;00 
}11 
}22 	
public:: 

Validacion:: 
ObtenerValidacion:: +
(::+ ,
int::, /
idValidacion::0 <
,::< =
bool::> B
incluirDetalle::C Q
=::R S
false::T Y
)::Y Z
{;; 	
using<< 
(<< 
	DbCommand<< 
cmd<<  
=<<! "
Contexto<<# +
.<<+ , 
GetStoredProcCommand<<, @
(<<@ A
$str<<A a
)<<a b
)<<b c
{== 
Contexto>> 
.>> 
AddInParameter>> '
(>>' (
cmd>>( +
,>>+ ,
$str>>- <
,>>< =
DbType>>> D
.>>D E
Int32>>E J
,>>J K
idValidacion>>L X
)>>X Y
;>>Y Z
using@@ 
(@@ 
var@@ 
reader@@ !
=@@" #
Contexto@@$ ,
.@@, -
ExecuteReader@@- :
(@@: ;
cmd@@; >
)@@> ?
)@@? @
{AA 
ifBB 
(BB 
readerBB 
.BB 
ReadBB #
(BB# $
)BB$ %
)BB% &
{CC 
varDD 

validacionDD &
=DD' (
newDD) ,

ValidacionDD- 7
(DD7 8
)DD8 9
;DD9 :

validacionEE "
.EE" #
IdValidacionEE# /
=EE0 1
ConvertEE2 9
.EE9 :
ToInt32EE: A
(EEA B
readerEEB H
[EEH I
$strEEI W
]EEW X
.EEX Y
ToStringEEY a
(EEa b
)EEb c
)EEc d
;EEd e

validacionFF "
.FF" #
TipoValidacionFF# 1
=FF2 3
ConvertFF4 ;
.FF; <
ToInt32FF< C
(FFC D
readerFFD J
[FFJ K
$strFFK [
]FF[ \
.FF\ ]
ToStringFF] e
(FFe f
)FFf g
)FFg h
;FFh i

validacionGG "
.GG" #
DescripcionGG# .
=GG/ 0
readerGG1 7
[GG7 8
$strGG8 E
]GGE F
.GGF G
ToStringGGG O
(GGO P
)GGP Q
;GGQ R

validacionHH "
.HH" #
ObjetivoHH# +
=HH, -
readerHH. 4
[HH4 5
$strHH5 ?
]HH? @
.HH@ A
ToStringHHA I
(HHI J
)HHJ K
;HHK L

validacionII "
.II" #
BaseDatosOrigenII# 2
=II3 4
readerII5 ;
[II; <
$strII< M
]IIM N
.IIN O
ToStringIIO W
(IIW X
)IIX Y
;IIY Z

validacionJJ "
.JJ" #
TablaOrigenJJ# .
=JJ/ 0
readerJJ1 7
[JJ7 8
$strJJ8 E
]JJE F
.JJF G
ToStringJJG O
(JJO P
)JJP Q
;JJQ R

validacionKK "
.KK" #
ActivoKK# )
=KK* +
ConvertKK- 4
.KK4 5
	ToBooleanKK5 >
(KK> ?
readerKK? E
[KKE F
$strKKF N
]KKN O
.KKO P
ToStringKKP X
(KKX Y
)KKY Z
)KKZ [
;KK[ \

validacionLL "
.LL" #
DetalleValidacionLL# 4
=LL5 6
incluirDetalleLL7 E
?LLF G$
ObtenerDetalleValidacionLLH `
(LL` a
idValidacionLLa m
)LLm n
:LLo p
nullLLq u
;LLu v
returnNN 

validacionNN )
;NN) *
}OO 
}PP 
returnRR 
nullRR 
;RR 
}SS 
}TT 	
public[[ 
List[[ 
<[[ 
DetalleValidacion[[ %
>[[% &$
ObtenerDetalleValidacion[[' ?
([[? @
int[[@ C
idValidacion[[D P
)[[P Q
{\\ 	
using]] 
(]] 
	DbCommand]] 
cmd]]  
=]]! "
Contexto]]# +
.]]+ , 
GetStoredProcCommand]], @
(]]@ A
$str]]A h
)]]h i
)]]i j
{^^ 
Contexto__ 
.__ 
AddInParameter__ '
(__' (
cmd__( +
,__+ ,
$str__- <
,__< =
DbType__> D
.__D E
Int32__E J
,__J K
idValidacion__L X
)__X Y
;__Y Z
varaa 
listadoaa 
=aa 
newaa !
Listaa" &
<aa& '
DetalleValidacionaa' 8
>aa8 9
(aa9 :
)aa: ;
;aa; <
usingcc 
(cc 
varcc 
readercc !
=cc" #
Contextocc$ ,
.cc, -
ExecuteReadercc- :
(cc: ;
cmdcc; >
)cc> ?
)cc? @
{dd 
whileee 
(ee 
readeree !
.ee! "
Readee" &
(ee& '
)ee' (
)ee( )
{ff 
vargg 
detallegg #
=gg$ %
newgg& )
DetalleValidaciongg* ;
(gg; <
)gg< =
;gg= >
detallehh 
.hh  
	IdDetallehh  )
=hh* +
Converthh, 3
.hh3 4
ToInt32hh4 ;
(hh; <
readerhh< B
[hhB C
$strhhC N
]hhN O
.hhO P
ToStringhhP X
(hhX Y
)hhY Z
)hhZ [
;hh[ \
detalleii 
.ii  
IdValidacionii  ,
=ii- .
Convertii/ 6
.ii6 7
ToInt32ii7 >
(ii> ?
readerii? E
[iiE F
$striiF T
]iiT U
.iiU V
ToStringiiV ^
(ii^ _
)ii_ `
)ii` a
;iia b
detallejj 
.jj  
Campojj  %
=jj& '
readerjj( .
[jj. /
$strjj/ 6
]jj6 7
.jj7 8
ToStringjj8 @
(jj@ A
)jjA B
;jjB C
detallekk 
.kk  
Operadorkk  (
=kk) *
readerkk+ 1
[kk1 2
$strkk2 <
]kk< =
.kk= >
ToStringkk> F
(kkF G
)kkG H
;kkH I
detallell 
.ll  
Valorll  %
=ll& '
readerll( .
[ll. /
$strll/ 6
]ll6 7
.ll7 8
ToStringll8 @
(ll@ A
)llA B
;llB C
listadonn 
.nn  
Addnn  #
(nn# $
detallenn$ +
)nn+ ,
;nn, -
}oo 
}pp 
returnrr 
listadorr 
;rr 
}ss 
}tt 	
public{{ 
bool{{ 
EjecutarValidacion{{ &
({{& '
int{{' *
idValidacion{{+ 7
){{7 8
{|| 	
using}} 
(}} 
	DbCommand}} 
cmd}}  
=}}! "
Contexto}}# +
.}}+ , 
GetStoredProcCommand}}, @
(}}@ A
$str}}A b
)}}b c
)}}c d
{~~ 
cmd 
. 
CommandTimeout "
=# $
$num% &
;& '
Contexto
ÄÄ 
.
ÄÄ 
AddInParameter
ÄÄ '
(
ÄÄ' (
cmd
ÄÄ( +
,
ÄÄ+ ,
$str
ÄÄ- <
,
ÄÄ< =
DbType
ÄÄ> D
.
ÄÄD E
Int32
ÄÄE J
,
ÄÄJ K
idValidacion
ÄÄL X
)
ÄÄX Y
;
ÄÄY Z
return
ÇÇ 
Contexto
ÇÇ 
.
ÇÇ  
ExecuteNonQuery
ÇÇ  /
(
ÇÇ/ 0
cmd
ÇÇ0 3
)
ÇÇ3 4
>
ÇÇ5 6
$num
ÇÇ7 8
;
ÇÇ8 9
}
ÉÉ 
}
ÑÑ 	
}
ÖÖ 
}ÜÜ 