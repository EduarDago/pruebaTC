ш
]G:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\ConexionTablero.cs
	namespace 	

Proteccion
 
. 
TableroControl #
.# $
Datos$ )
.) *
DAO* -
{		 
public

 

abstract

 
class

 
ConexionTablero

 )
{ 
	protected 
Database 
Contexto #
;# $
	protected 
ConexionTablero !
(! "
IConfiguration" 0
config1 7
)7 8
{ 	
string 
connectionString #
=$ %
config& ,
., -
GetConnectionString- @
(@ A
$strA Q
)Q R
;R S
Contexto 
= 
new 
SqlDatabase &
(& '
connectionString' 7
)7 8
;8 9
} 	
} 
} зр
fG:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\ConfiguracionOrigenDatos.cs
	namespace		 	

Proteccion		
 
.		 
TableroControl		 #
.		# $
Datos		$ )
.		) *
DAO		* -
{

 
public 

class $
ConfiguracionOrigenDatos )
:* +
ConexionTablero, ;
{ 
public $
ConfiguracionOrigenDatos '
(' (
IConfiguration( 6
config7 =
)= >
:? @
baseA E
(E F
configF L
)L M
{ 	
} 	
public 
List 
< 
ConfiguracionOrigen '
>' ((
ObtenerConfiguracionesOrigen) E
(E F
)F G
{ 	
using 
( 
	DbCommand 
cmd  
=! "
Contexto# +
.+ , 
GetStoredProcCommand, @
(@ A
$strA o
)o p
)p q
{ 
var 
listado 
= 
new !
List" &
<& '
ConfiguracionOrigen' :
>: ;
(; <
)< =
;= >
using 
( 
var 
reader !
=" #
Contexto$ ,
., -
ExecuteReader- :
(: ;
cmd; >
)> ?
)? @
{ 
while 
( 
reader !
.! "
Read" &
(& '
)' (
)( )
{ 
var   
configuracion   )
=  * +
new  , /
ConfiguracionOrigen  0 C
(  C D
)  D E
;  E F
configuracion!! %
.!!% &
IdConfiguracion!!& 5
=!!6 7
Convert!!8 ?
.!!? @
ToInt32!!@ G
(!!G H
reader!!H N
[!!N O
$str!!O f
]!!f g
.!!g h
ToString!!h p
(!!p q
)!!q r
)!!r s
;!!s t
configuracion"" %
.""% &
Nombre""& ,
=""- .
reader""/ 5
[""5 6
$str""6 >
]""> ?
.""? @
ToString""@ H
(""H I
)""I J
;""J K
configuracion## %
.##% &
Descripcion##& 1
=##2 3
reader##4 :
[##: ;
$str##; H
]##H I
.##I J
ToString##J R
(##R S
)##S T
;##T U
configuracion$$ %
.$$% &
Procedimiento$$& 3
=$$4 5
reader$$6 <
[$$< =
$str$$= L
]$$L M
.$$M N
ToString$$N V
($$V W
)$$W X
;$$X Y
configuracion%% %
.%%% &
NombreTabla%%& 1
=%%2 3
reader%%4 :
[%%: ;
$str%%; H
]%%H I
.%%I J
ToString%%J R
(%%R S
)%%S T
;%%T U
listado'' 
.''  
Add''  #
(''# $
configuracion''$ 1
)''1 2
;''2 3
}(( 
})) 
return++ 
listado++ 
;++ 
},, 
}-- 	
public33 
ConfiguracionOrigen33 "&
ObtenerConfiguracionOrigen33# =
(33= >
int33> A
idConfiguracion33B Q
)33Q R
{44 	
using55 
(55 
	DbCommand55 
cmd55  
=55! "
Contexto55# +
.55+ , 
GetStoredProcCommand55, @
(55@ A
$str55A m
)55m n
)55n o
{66 
Contexto77 
.77 
AddInParameter77 '
(77' (
cmd77( +
,77+ ,
$str77- ?
,77? @
DbType77A G
.77G H
Int3277H M
,77M N
idConfiguracion77O ^
)77^ _
;77_ `
ConfiguracionOrigen99 #
configuracion99$ 1
=992 3
null994 8
;998 9
using;; 
(;; 
var;; 
reader;; !
=;;" #
Contexto;;$ ,
.;;, -
ExecuteReader;;- :
(;;: ;
cmd;;; >
);;> ?
);;? @
{<< 
if== 
(== 
reader== 
.== 
Read== "
(==" #
)==# $
)==$ %
{>> 
configuracion?? %
=??& '
new??( +
ConfiguracionOrigen??, ?
(??? @
)??@ A
;??A B
configuracion@@ %
.@@% &
IdConfiguracion@@& 5
=@@6 7
Convert@@8 ?
.@@? @
ToInt32@@@ G
(@@G H
reader@@H N
[@@N O
$str@@O f
]@@f g
.@@g h
ToString@@h p
(@@p q
)@@q r
)@@r s
;@@s t
configuracionAA %
.AA% &
NombreAA& ,
=AA- .
readerAA/ 5
[AA5 6
$strAA6 >
]AA> ?
.AA? @
ToStringAA@ H
(AAH I
)AAI J
;AAJ K
configuracionBB %
.BB% &
DescripcionBB& 1
=BB2 3
readerBB4 :
[BB: ;
$strBB; H
]BBH I
.BBI J
ToStringBBJ R
(BBR S
)BBS T
;BBT U
configuracionCC %
.CC% &
ProcedimientoCC& 3
=CC4 5
readerCC6 <
[CC< =
$strCC= L
]CCL M
.CCM N
ToStringCCN V
(CCV W
)CCW X
;CCX Y
configuracionDD %
.DD% &
NombreTablaDD& 1
=DD2 3
readerDD4 :
[DD: ;
$strDD; H
]DDH I
.DDI J
ToStringDDJ R
(DDR S
)DDS T
;DDT U
configuracionEE %
.EE% &

ParametrosEE& 0
=EE1 2#
ObtenerParametrosOrigenEE3 J
(EEJ K
idConfiguracionEEK Z
)EEZ [
;EE[ \
configuracionFF %
.FF% &
CamposFF& ,
=FF- .
ObtenerCamposOrigenFF/ B
(FFB C
idConfiguracionFFC R
)FFR S
;FFS T
}GG 
}HH 
returnJJ 
configuracionJJ $
;JJ$ %
}KK 
}LL 	
publicRR 
ListRR 
<RR 
ParametroOrigenRR #
>RR# $#
ObtenerParametrosOrigenRR% <
(RR< =
intRR= @
idConfiguracionRRA P
)RRP Q
{SS 	
usingTT 
(TT 
	DbCommandTT 
cmdTT  
=TT! "
ContextoTT# +
.TT+ , 
GetStoredProcCommandTT, @
(TT@ A
$strTTA j
)TTj k
)TTk l
{UU 
ContextoVV 
.VV 
AddInParameterVV '
(VV' (
cmdVV( +
,VV+ ,
$strVV- ?
,VV? @
DbTypeVVA G
.VVG H
Int32VVH M
,VVM N
idConfiguracionVVO ^
)VV^ _
;VV_ `
varWW 
listadoWW 
=WW 
newWW !
ListWW" &
<WW& '
ParametroOrigenWW' 6
>WW6 7
(WW7 8
)WW8 9
;WW9 :
usingYY 
(YY 
varYY 
readerYY !
=YY" #
ContextoYY$ ,
.YY, -
ExecuteReaderYY- :
(YY: ;
cmdYY; >
)YY> ?
)YY? @
{ZZ 
while[[ 
([[ 
reader[[ !
.[[! "
Read[[" &
([[& '
)[[' (
)[[( )
{\\ 
var]] 
	parametro]] %
=]]& '
new]]( +
ParametroOrigen]], ;
(]]; <
)]]< =
;]]= >
	parametro^^ !
.^^! "
Id^^" $
=^^% &
Convert^^' .
.^^. /
ToInt32^^/ 6
(^^6 7
reader^^7 =
[^^= >
$str^^> B
]^^B C
.^^C D
ToString^^D L
(^^L M
)^^M N
)^^N O
;^^O P
	parametro__ !
.__! "
IdConfiguracion__" 1
=__2 3
Convert__4 ;
.__; <
ToInt32__< C
(__C D
reader__D J
[__J K
$str__K b
]__b c
.__c d
ToString__d l
(__l m
)__m n
)__n o
;__o p
	parametro`` !
.``! "
Nombre``" (
=``) *
reader``+ 1
[``1 2
$str``2 :
]``: ;
.``; <
ToString``< D
(``D E
)``E F
;``F G
	parametroaa !
.aa! "
TipoDatoaa" *
=aa+ ,
readeraa- 3
[aa3 4
$straa4 >
]aa> ?
.aa? @
ToStringaa@ H
(aaH I
)aaI J
;aaJ K
listadocc 
.cc  
Addcc  #
(cc# $
	parametrocc$ -
)cc- .
;cc. /
}dd 
}ee 
returngg 
listadogg 
;gg 
}hh 
}ii 	
publicoo 
Listoo 
<oo 
CampoOrigenoo 
>oo  
ObtenerCamposOrigenoo! 4
(oo4 5
intoo5 8
idConfiguracionoo9 H
)ooH I
{pp 	
usingqq 
(qq 
	DbCommandqq 
cmdqq  
=qq! "
Contextoqq# +
.qq+ , 
GetStoredProcCommandqq, @
(qq@ A
$strqqA f
)qqf g
)qqg h
{rr 
Contextoss 
.ss 
AddInParameterss '
(ss' (
cmdss( +
,ss+ ,
$strss- ?
,ss? @
DbTypessA G
.ssG H
Int32ssH M
,ssM N
idConfiguracionssO ^
)ss^ _
;ss_ `
vartt 
listadott 
=tt 
newtt !
Listtt" &
<tt& '
CampoOrigentt' 2
>tt2 3
(tt3 4
)tt4 5
;tt5 6
usingvv 
(vv 
varvv 
readervv !
=vv" #
Contextovv$ ,
.vv, -
ExecuteReadervv- :
(vv: ;
cmdvv; >
)vv> ?
)vv? @
{ww 
whilexx 
(xx 
readerxx !
.xx! "
Readxx" &
(xx& '
)xx' (
)xx( )
{yy 
varzz 
campozz !
=zz" #
newzz$ '
CampoOrigenzz( 3
(zz3 4
)zz4 5
;zz5 6
campo{{ 
.{{ 
Id{{  
={{! "
Convert{{# *
.{{* +
ToInt32{{+ 2
({{2 3
reader{{3 9
[{{9 :
$str{{: >
]{{> ?
.{{? @
ToString{{@ H
({{H I
){{I J
){{J K
;{{K L
campo|| 
.|| 
IdConfiguracion|| -
=||. /
Convert||0 7
.||7 8
ToInt32||8 ?
(||? @
reader||@ F
[||F G
$str||G ^
]||^ _
.||_ `
ToString||` h
(||h i
)||i j
)||j k
;||k l
campo}} 
.}} 
Nombre}} $
=}}% &
reader}}' -
[}}- .
$str}}. 6
]}}6 7
.}}7 8
ToString}}8 @
(}}@ A
)}}A B
;}}B C
campo~~ 
.~~ 
TipoDato~~ &
=~~' (
reader~~) /
[~~/ 0
$str~~0 :
]~~: ;
.~~; <
ToString~~< D
(~~D E
)~~E F
;~~F G
listado
── 
.
──  
Add
──  #
(
──# $
campo
──$ )
)
──) *
;
──* +
}
││ 
}
┌┌ 
return
└└ 
listado
└└ 
;
└└ 
}
┘┘ 
}
├├ 	
public
▄▄ 
List
▄▄ 
<
▄▄ "
EjecucionImportacion
▄▄ (
>
▄▄( )"
ConsultarEjecuciones
▄▄* >
(
▄▄> ?
)
▄▄? @
{
██ 	
using
▌▌ 
(
▌▌ 
	DbCommand
▌▌ 
cmd
▌▌  
=
▌▌! "
Contexto
▌▌# +
.
▌▌+ ,"
GetStoredProcCommand
▌▌, @
(
▌▌@ A
$str
▌▌A e
)
▌▌e f
)
▌▌f g
{
▐▐ 
var
░░ 
listado
░░ 
=
░░ 
new
░░ !
List
░░" &
<
░░& '"
EjecucionImportacion
░░' ;
>
░░; <
(
░░< =
)
░░= >
;
░░> ?
using
▓▓ 
(
▓▓ 
var
▓▓ 
reader
▓▓ !
=
▓▓" #
Contexto
▓▓$ ,
.
▓▓, -
ExecuteReader
▓▓- :
(
▓▓: ;
cmd
▓▓; >
)
▓▓> ?
)
▓▓? @
{
⌠⌠ 
while
■■ 
(
■■ 
reader
■■ !
.
■■! "
Read
■■" &
(
■■& '
)
■■' (
)
■■( )
{
∙∙ 
var
√√ 
	ejecucion
√√ %
=
√√& '
new
√√( +"
EjecucionImportacion
√√, @
(
√√@ A
)
√√A B
;
√√B C
	ejecucion
≈≈ !
.
≈≈! "
IdEjecucion
≈≈" -
=
≈≈. /
Convert
≈≈0 7
.
≈≈7 8
ToInt32
≈≈8 ?
(
≈≈? @
reader
≈≈@ F
[
≈≈F G
$str
≈≈G T
]
≈≈T U
.
≈≈U V
ToString
≈≈V ^
(
≈≈^ _
)
≈≈_ `
)
≈≈` a
;
≈≈a b
	ejecucion
≤≤ !
.
≤≤! "#
IdConfiguracionOrigen
≤≤" 7
=
≤≤8 9
Convert
≤≤: A
.
≤≤A B
ToInt32
≤≤B I
(
≤≤I J
reader
≤≤J P
[
≤≤P Q
$str
≤≤Q h
]
≤≤h i
.
≤≤i j
ToString
≤≤j r
(
≤≤r s
)
≤≤s t
)
≤≤t u
;
≤≤u v
	ejecucion
≥≥ !
.
≥≥! "
NombreOrigen
≥≥" .
=
≥≥/ 0
reader
≥≥1 7
[
≥≥7 8
$str
≥≥8 @
]
≥≥@ A
.
≥≥A B
ToString
≥≥B J
(
≥≥J K
)
≥≥K L
;
≥≥L M
	ejecucion
   !
.
  ! "
FechaEjecucion
  " 0
=
  1 2
Convert
  3 :
.
  : ;

ToDateTime
  ; E
(
  E F
reader
  F L
[
  L M
$str
  M ]
]
  ] ^
.
  ^ _
ToString
  _ g
(
  g h
)
  h i
)
  i j
;
  j k
	ejecucion
⌡⌡ !
.
⌡⌡! "
Estado
⌡⌡" (
=
⌡⌡) *
reader
⌡⌡+ 1
[
⌡⌡1 2
$str
⌡⌡2 :
]
⌡⌡: ;
.
⌡⌡; <
ToString
⌡⌡< D
(
⌡⌡D E
)
⌡⌡E F
;
⌡⌡F G
	ejecucion
°° !
.
°°! "
CantidadRegistros
°°" 3
=
°°4 5
Convert
°°6 =
.
°°= >
ToInt32
°°> E
(
°°E F
reader
°°F L
[
°°L M
$str
°°M `
]
°°` a
.
°°a b
ToString
°°b j
(
°°j k
)
°°k l
)
°°l m
;
°°m n
listado
·· 
.
··  
Add
··  #
(
··# $
	ejecucion
··$ -
)
··- .
;
··. /
}
÷÷ 
}
══ 
return
╒╒ 
listado
╒╒ 
;
╒╒ 
}
ёё 
}
╓╓ 	
public
╚╚ "
EjecucionImportacion
╚╚ #!
EjecutarImportacion
╚╚$ 7
(
╚╚7 8
int
╚╚8 ;
idConfiguracion
╚╚< K
)
╚╚K L
{
╛╛ 	
using
╜╜ 
(
╜╜ 
	DbCommand
╜╜ 
cmd
╜╜  
=
╜╜! "
Contexto
╜╜# +
.
╜╜+ ,"
GetStoredProcCommand
╜╜, @
(
╜╜@ A
$str
╜╜A f
)
╜╜f g
)
╜╜g h
{
╝╝ 
cmd
╞╞ 
.
╞╞ 
CommandTimeout
╞╞ "
=
╞╞# $
$num
╞╞% &
;
╞╞& '
Contexto
╟╟ 
.
╟╟ 
AddInParameter
╟╟ '
(
╟╟' (
cmd
╟╟( +
,
╟╟+ ,
$str
╟╟- ?
,
╟╟? @
DbType
╟╟A G
.
╟╟G H
Int32
╟╟H M
,
╟╟M N
idConfiguracion
╟╟O ^
)
╟╟^ _
;
╟╟_ `"
EjecucionImportacion
╡╡ $
	ejecucion
╡╡% .
=
╡╡/ 0
null
╡╡1 5
;
╡╡5 6
using
╢╢ 
(
╢╢ 
var
╢╢ 
reader
╢╢ !
=
╢╢" #
Contexto
╢╢$ ,
.
╢╢, -
ExecuteReader
╢╢- :
(
╢╢: ;
cmd
╢╢; >
)
╢╢> ?
)
╢╢? @
{
╣╣ 
if
╤╤ 
(
╤╤ 
reader
╤╤ 
.
╤╤ 
Read
╤╤ #
(
╤╤# $
)
╤╤$ %
)
╤╤% &
{
╥╥ 
	ejecucion
╦╦ !
=
╦╦" #
new
╦╦$ '"
EjecucionImportacion
╦╦( <
(
╦╦< =
)
╦╦= >
;
╦╦> ?
	ejecucion
╨╨ !
.
╨╨! "#
IdConfiguracionOrigen
╨╨" 7
=
╨╨8 9
idConfiguracion
╨╨: I
;
╨╨I J
	ejecucion
╩╩ !
.
╩╩! "
Estado
╩╩" (
=
╩╩) *
reader
╩╩+ 1
[
╩╩1 2
$str
╩╩2 :
]
╩╩: ;
.
╩╩; <
ToString
╩╩< D
(
╩╩D E
)
╩╩E F
;
╩╩F G
	ejecucion
╪╪ !
.
╪╪! "
CantidadRegistros
╪╪" 3
=
╪╪4 5
Convert
╪╪6 =
.
╪╪= >
ToInt32
╪╪> E
(
╪╪E F
reader
╪╪F L
[
╪╪L M
$str
╪╪M X
]
╪╪X Y
.
╪╪Y Z
ToString
╪╪Z b
(
╪╪b c
)
╪╪c d
)
╪╪d e
;
╪╪e f
}
╫╫ 
}
╬╬ 
return
юю 
	ejecucion
юю  
;
юю  !
}
аа 
}
бб 	
public
ии 
bool
ии )
InsertarConfiguracionOrigen
ии /
(
ии/ 0!
ConfiguracionOrigen
ии0 C
configuracion
ииD Q
)
ииQ R
{
йй 	
using
кк 
(
кк 
	DbCommand
кк 
cmd
кк  
=
кк! "
Contexto
кк# +
.
кк+ ,"
GetStoredProcCommand
кк, @
(
кк@ A
$str
ккA l
)
ккl m
)
ккm n
{
лл 
int
мм 
idConfiguracion
мм #
=
мм$ %
$num
мм& '
;
мм' (
Contexto
оо 
.
оо 
AddInParameter
оо '
(
оо' (
cmd
оо( +
,
оо+ ,
$str
оо- 6
,
оо6 7
DbType
оо8 >
.
оо> ?
String
оо? E
,
ооE F
configuracion
ооG T
.
ооT U
Nombre
ооU [
)
оо[ \
;
оо\ ]
Contexto
пп 
.
пп 
AddInParameter
пп '
(
пп' (
cmd
пп( +
,
пп+ ,
$str
пп- ;
,
пп; <
DbType
пп= C
.
ппC D
String
ппD J
,
ппJ K
configuracion
ппL Y
.
ппY Z
Descripcion
ппZ e
)
ппe f
;
ппf g
Contexto
яя 
.
яя 
AddInParameter
яя '
(
яя' (
cmd
яя( +
,
яя+ ,
$str
яя- =
,
яя= >
DbType
яя? E
.
яяE F
String
яяF L
,
яяL M
configuracion
яяN [
.
яя[ \
Procedimiento
яя\ i
)
яяi j
;
яяj k
Contexto
рр 
.
рр 
AddInParameter
рр '
(
рр' (
cmd
рр( +
,
рр+ ,
$str
рр- ;
,
рр; <
DbType
рр= C
.
ррC D
String
ррD J
,
ррJ K
configuracion
ррL Y
.
ррY Z
NombreTabla
ррZ e
)
ррe f
;
ррf g
using
тт 
(
тт 
DbConnection
тт #
conn
тт$ (
=
тт) *
Contexto
тт+ 3
.
тт3 4
CreateConnection
тт4 D
(
ттD E
)
ттE F
)
ттF G
{
уу 
conn
жж 
.
жж 
Open
жж 
(
жж 
)
жж 
;
жж  
DbTransaction
вв !
transaccion
вв" -
=
вв. /
conn
вв0 4
.
вв4 5
BeginTransaction
вв5 E
(
ввE F
)
ввF G
;
ввG H
try
ыы 
{
зз 
using
шш 
(
шш 
var
шш "
reader
шш# )
=
шш* +
Contexto
шш, 4
.
шш4 5
ExecuteReader
шш5 B
(
шшB C
cmd
шшC F
)
шшF G
)
шшG H
{
ээ 
if
щщ 
(
щщ  
reader
щщ  &
.
щщ& '
Read
щщ' +
(
щщ+ ,
)
щщ, -
)
щщ- .
{
чч 
idConfiguracion
ъъ  /
=
ъъ0 1
Convert
ъъ2 9
.
ъъ9 :
ToInt32
ъъ: A
(
ъъA B
reader
ъъB H
[
ъъH I
$str
ъъI M
]
ъъM N
.
ъъN O
ToString
ъъO W
(
ъъW X
)
ъъX Y
)
ъъY Z
;
ъъZ [
}
ЮЮ 
}
АА 
foreach
ЦЦ 
(
ЦЦ  !
var
ЦЦ! $
campo
ЦЦ% *
in
ЦЦ+ -
configuracion
ЦЦ. ;
.
ЦЦ; <
Campos
ЦЦ< B
)
ЦЦB C
{
ДД 
campo
ЕЕ !
.
ЕЕ! "
IdConfiguracion
ЕЕ" 1
=
ЕЕ2 3
idConfiguracion
ЕЕ4 C
;
ЕЕC D!
InsertarCampoOrigen
ФФ /
(
ФФ/ 0
campo
ФФ0 5
)
ФФ5 6
;
ФФ6 7
}
ГГ 
foreach
ИИ 
(
ИИ  !
var
ИИ! $
	parametro
ИИ% .
in
ИИ/ 1
configuracion
ИИ2 ?
.
ИИ? @

Parametros
ИИ@ J
)
ИИJ K
{
ЙЙ 
	parametro
КК %
.
КК% &
IdConfiguracion
КК& 5
=
КК6 7
idConfiguracion
КК8 G
;
ККG H%
InsertarParametroOrigen
ЛЛ 3
(
ЛЛ3 4
	parametro
ЛЛ4 =
)
ЛЛ= >
;
ЛЛ> ?
}
ММ 
CrearEstructura
ОО '
(
ОО' (
idConfiguracion
ОО( 7
)
ОО7 8
;
ОО8 9
transaccion
ЯЯ #
.
ЯЯ# $
Commit
ЯЯ$ *
(
ЯЯ* +
)
ЯЯ+ ,
;
ЯЯ, -
return
СС 
true
СС #
;
СС# $
}
ТТ 
catch
УУ 
{
ЖЖ 
transaccion
ВВ #
.
ВВ# $
Rollback
ВВ$ ,
(
ВВ, -
)
ВВ- .
;
ВВ. /
return
ЬЬ 
false
ЬЬ $
;
ЬЬ$ %
}
ЫЫ 
finally
ЗЗ 
{
ШШ 
conn
ЭЭ 
.
ЭЭ 
Close
ЭЭ "
(
ЭЭ" #
)
ЭЭ# $
;
ЭЭ$ %
}
ЩЩ 
}
ЧЧ 
}
ЪЪ 
}
── 	
private
┤┤ 
void
┤┤ !
InsertarCampoOrigen
┤┤ (
(
┤┤( )
CampoOrigen
┤┤) 4
campo
┤┤5 :
)
┤┤: ;
{
┬┬ 	
using
┴┴ 
(
┴┴ 
	DbCommand
┴┴ 
cmd
┴┴  
=
┴┴! "
Contexto
┴┴# +
.
┴┴+ ,"
GetStoredProcCommand
┴┴, @
(
┴┴@ A
$str
┴┴A d
)
┴┴d e
)
┴┴e f
{
┼┼ 
Contexto
▀▀ 
.
▀▀ 
AddInParameter
▀▀ '
(
▀▀' (
cmd
▀▀( +
,
▀▀+ ,
$str
▀▀- E
,
▀▀E F
DbType
▀▀G M
.
▀▀M N
Int32
▀▀N S
,
▀▀S T
campo
▀▀U Z
.
▀▀Z [
IdConfiguracion
▀▀[ j
)
▀▀j k
;
▀▀k l
Contexto
▄▄ 
.
▄▄ 
AddInParameter
▄▄ '
(
▄▄' (
cmd
▄▄( +
,
▄▄+ ,
$str
▄▄- 6
,
▄▄6 7
DbType
▄▄8 >
.
▄▄> ?
String
▄▄? E
,
▄▄E F
campo
▄▄G L
.
▄▄L M
Nombre
▄▄M S
)
▄▄S T
;
▄▄T U
Contexto
██ 
.
██ 
AddInParameter
██ '
(
██' (
cmd
██( +
,
██+ ,
$str
██- 8
,
██8 9
DbType
██: @
.
██@ A
String
██A G
,
██G H
campo
██I N
.
██N O
TipoDato
██O W
)
██W X
;
██X Y
Contexto
▐▐ 
.
▐▐ 
ExecuteNonQuery
▐▐ (
(
▐▐( )
cmd
▐▐) ,
)
▐▐, -
;
▐▐- .
}
░░ 
}
▒▒ 	
private
≤≤ 
void
≤≤ %
InsertarParametroOrigen
≤≤ ,
(
≤≤, -
ParametroOrigen
≤≤- <
	parametro
≤≤= F
)
≤≤F G
{
≥≥ 	
using
   
(
   
	DbCommand
   
cmd
    
=
  ! "
Contexto
  # +
.
  + ,"
GetStoredProcCommand
  , @
(
  @ A
$str
  A h
)
  h i
)
  i j
{
⌡⌡ 
Contexto
°° 
.
°° 
AddInParameter
°° '
(
°°' (
cmd
°°( +
,
°°+ ,
$str
°°- E
,
°°E F
DbType
°°G M
.
°°M N
Int32
°°N S
,
°°S T
	parametro
°°U ^
.
°°^ _
IdConfiguracion
°°_ n
)
°°n o
;
°°o p
Contexto
²² 
.
²² 
AddInParameter
²² '
(
²²' (
cmd
²²( +
,
²²+ ,
$str
²²- 6
,
²²6 7
DbType
²²8 >
.
²²> ?
String
²²? E
,
²²E F
	parametro
²²G P
.
²²P Q
Nombre
²²Q W
)
²²W X
;
²²X Y
Contexto
·· 
.
·· 
AddInParameter
·· '
(
··' (
cmd
··( +
,
··+ ,
$str
··- 8
,
··8 9
DbType
··: @
.
··@ A
String
··A G
,
··G H
	parametro
··I R
.
··R S
TipoDato
··S [
)
··[ \
;
··\ ]
Contexto
══ 
.
══ 
ExecuteNonQuery
══ (
(
══( )
cmd
══) ,
)
══, -
;
══- .
}
║║ 
}
╒╒ 	
private
╘╘ 
void
╘╘ 
CrearEstructura
╘╘ $
(
╘╘$ %
int
╘╘% (
idConfiguracion
╘╘) 8
)
╘╘8 9
{
╙╙ 	
using
╚╚ 
(
╚╚ 
	DbCommand
╚╚ 
cmd
╚╚  
=
╚╚! "
Contexto
╚╚# +
.
╚╚+ ,"
GetStoredProcCommand
╚╚, @
(
╚╚@ A
$str
╚╚A `
)
╚╚` a
)
╚╚a b
{
╛╛ 
Contexto
╜╜ 
.
╜╜ 
AddInParameter
╜╜ '
(
╜╜' (
cmd
╜╜( +
,
╜╜+ ,
$str
╜╜- ?
,
╜╜? @
DbType
╜╜A G
.
╜╜G H
Int32
╜╜H M
,
╜╜M N
idConfiguracion
╜╜O ^
)
╜╜^ _
;
╜╜_ `
Contexto
╝╝ 
.
╝╝ 
ExecuteNonQuery
╝╝ (
(
╝╝( )
cmd
╝╝) ,
)
╝╝, -
;
╝╝- .
}
╞╞ 
}
╟╟ 	
}
╠╠ 
}╡╡ В
YG:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\TopicoDatos.cs
	namespace		 	

Proteccion		
 
.		 
TableroControl		 #
.		# $
Datos		$ )
.		) *
DAO		* -
{

 
public 

class 
TopicoDatos 
: 
ConexionTablero .
{ 
public 
TopicoDatos 
( 
IConfiguration )
config* 0
)0 1
:2 3
base4 8
(8 9
config9 ?
)? @
{ 	
} 	
public 
List 
< 
Topico 
> 
ObtenerTopicos *
(* +
string+ 1
identificador2 ?
)? @
{ 	
using 
( 
	DbCommand 
cmd  
=! "
Contexto# +
.+ , 
GetStoredProcCommand, @
(@ A
$strA Z
)Z [
)[ \
{ 
Contexto 
. 
AddInParameter '
(' (
cmd( +
,+ ,
$str- =
,= >
DbType? E
.E F
StringF L
,L M
identificadorN [
)[ \
;\ ]
var 
listado 
= 
new !
List" &
<& '
Topico' -
>- .
(. /
)/ 0
;0 1
using 
( 
var 
reader !
=" #
Contexto$ ,
., -
ExecuteReader- :
(: ;
cmd; >
)> ?
)? @
{ 
while   
(   
reader   !
.  ! "
Read  " &
(  & '
)  ' (
)  ( )
{!! 
var"" 
topico"" "
=""# $
new""% (
Topico"") /
(""/ 0
)""0 1
;""1 2
topico## 
.## 
IdTopico## '
=##( )
Convert##* 1
.##1 2
ToInt32##2 9
(##9 :
reader##: @
[##@ A
$str##A K
]##K L
.##L M
ToString##M U
(##U V
)##V W
)##W X
;##X Y
topico$$ 
.$$ 
Identificador$$ ,
=$$- .
reader$$/ 5
[$$5 6
$str$$6 E
]$$E F
.$$F G
ToString$$G O
($$O P
)$$P Q
;$$Q R
topico%% 
.%% 
Valor%% $
=%%% &
reader%%' -
[%%- .
$str%%. 5
]%%5 6
.%%6 7
ToString%%7 ?
(%%? @
)%%@ A
;%%A B
topico&& 
.&& 
TextoMostrar&& +
=&&, -
reader&&. 4
[&&4 5
$str&&5 C
]&&C D
.&&D E
ToString&&E M
(&&M N
)&&N O
;&&O P
topico'' 
.'' 
Orden'' $
=''% &
Convert''' .
.''. /
ToInt32''/ 6
(''6 7
reader''7 =
[''= >
$str''> E
]''E F
.''F G
ToString''G O
(''O P
)''P Q
)''Q R
;''R S
listado)) 
.))  
Add))  #
())# $
topico))$ *
)))* +
;))+ ,
}** 
}++ 
return-- 
listado-- 
;-- 
}.. 
}// 	
}00 
}11 пY
]G:\Proyectos\Proteccion.TableroControl\Proteccion.TableroControl.Datos\DAO\ValidacionDatos.cs
	namespace 	

Proteccion
 
. 
TableroControl #
.# $
Datos$ )
.) *
DAO* -
{ 
public 

class 
ValidacionDatos  
:! "
ConexionTablero# 2
{ 
public 
ValidacionDatos 
( 
IConfiguration -
config. 4
)4 5
:6 7
base8 <
(< =
config= C
)C D
{ 	
} 	
public 
List 
< 

Validacion 
> 
ObtenerValidaciones  3
(3 4
)4 5
{ 	
using 
( 
	DbCommand 
cmd  
=! "
Contexto# +
.+ , 
GetStoredProcCommand, @
(@ A
$strA c
)c d
)d e
{ 
var 
listado 
= 
new !
List" &
<& '

Validacion' 1
>1 2
(2 3
)3 4
;4 5
using 
( 
var 
reader !
=" #
Contexto$ ,
., -
ExecuteReader- :
(: ;
cmd; >
)> ?
)? @
{   
while!! 
(!! 
reader!! !
.!!! "
Read!!" &
(!!& '
)!!' (
)!!( )
{"" 
var## 

validacion## &
=##' (
new##) ,

Validacion##- 7
(##7 8
)##8 9
;##9 :

validacion$$ "
.$$" #
IdValidacion$$# /
=$$0 1
Convert$$2 9
.$$9 :
ToInt32$$: A
($$A B
reader$$B H
[$$H I
$str$$I W
]$$W X
.$$X Y
ToString$$Y a
($$a b
)$$b c
)$$c d
;$$d e

validacion%% "
.%%" #
TipoValidacion%%# 1
=%%2 3
Convert%%4 ;
.%%; <
ToInt32%%< C
(%%C D
reader%%D J
[%%J K
$str%%K [
]%%[ \
.%%\ ]
ToString%%] e
(%%e f
)%%f g
)%%g h
;%%h i

validacion&& "
.&&" #
Descripcion&&# .
=&&/ 0
reader&&1 7
[&&7 8
$str&&8 E
]&&E F
.&&F G
ToString&&G O
(&&O P
)&&P Q
;&&Q R

validacion'' "
.''" #
Objetivo''# +
='', -
reader''. 4
[''4 5
$str''5 ?
]''? @
.''@ A
ToString''A I
(''I J
)''J K
;''K L

validacion(( "
.((" #
BaseDatosOrigen((# 2
=((3 4
reader((5 ;
[((; <
$str((< M
]((M N
.((N O
ToString((O W
(((W X
)((X Y
;((Y Z

validacion)) "
.))" #
TablaOrigen))# .
=))/ 0
reader))1 7
[))7 8
$str))8 E
]))E F
.))F G
ToString))G O
())O P
)))P Q
;))Q R

validacion** "
.**" #
Activo**# )
=*** +
Convert**, 3
.**3 4
	ToBoolean**4 =
(**= >
reader**> D
[**D E
$str**E M
]**M N
.**N O
ToString**O W
(**W X
)**X Y
)**Y Z
;**Z [
listado,, 
.,,  
Add,,  #
(,,# $

validacion,,$ .
),,. /
;,,/ 0
}-- 
}.. 
return00 
listado00 
;00 
}11 
}22 	
public:: 

Validacion:: 
ObtenerValidacion:: +
(::+ ,
int::, /
idValidacion::0 <
,::< =
bool::> B
incluirDetalle::C Q
=::R S
false::T Y
)::Y Z
{;; 	
using<< 
(<< 
	DbCommand<< 
cmd<<  
=<<! "
Contexto<<# +
.<<+ , 
GetStoredProcCommand<<, @
(<<@ A
$str<<A a
)<<a b
)<<b c
{== 
Contexto>> 
.>> 
AddInParameter>> '
(>>' (
cmd>>( +
,>>+ ,
$str>>- <
,>>< =
DbType>>> D
.>>D E
Int32>>E J
,>>J K
idValidacion>>L X
)>>X Y
;>>Y Z
using@@ 
(@@ 
var@@ 
reader@@ !
=@@" #
Contexto@@$ ,
.@@, -
ExecuteReader@@- :
(@@: ;
cmd@@; >
)@@> ?
)@@? @
{AA 
ifBB 
(BB 
readerBB 
.BB 
ReadBB #
(BB# $
)BB$ %
)BB% &
{CC 
varDD 

validacionDD &
=DD' (
newDD) ,

ValidacionDD- 7
(DD7 8
)DD8 9
;DD9 :

validacionEE "
.EE" #
IdValidacionEE# /
=EE0 1
ConvertEE2 9
.EE9 :
ToInt32EE: A
(EEA B
readerEEB H
[EEH I
$strEEI W
]EEW X
.EEX Y
ToStringEEY a
(EEa b
)EEb c
)EEc d
;EEd e

validacionFF "
.FF" #
TipoValidacionFF# 1
=FF2 3
ConvertFF4 ;
.FF; <
ToInt32FF< C
(FFC D
readerFFD J
[FFJ K
$strFFK [
]FF[ \
.FF\ ]
ToStringFF] e
(FFe f
)FFf g
)FFg h
;FFh i

validacionGG "
.GG" #
DescripcionGG# .
=GG/ 0
readerGG1 7
[GG7 8
$strGG8 E
]GGE F
.GGF G
ToStringGGG O
(GGO P
)GGP Q
;GGQ R

validacionHH "
.HH" #
ObjetivoHH# +
=HH, -
readerHH. 4
[HH4 5
$strHH5 ?
]HH? @
.HH@ A
ToStringHHA I
(HHI J
)HHJ K
;HHK L

validacionII "
.II" #
BaseDatosOrigenII# 2
=II3 4
readerII5 ;
[II; <
$strII< M
]IIM N
.IIN O
ToStringIIO W
(IIW X
)IIX Y
;IIY Z

validacionJJ "
.JJ" #
TablaOrigenJJ# .
=JJ/ 0
readerJJ1 7
[JJ7 8
$strJJ8 E
]JJE F
.JJF G
ToStringJJG O
(JJO P
)JJP Q
;JJQ R

validacionKK "
.KK" #
ActivoKK# )
=KK* +
ConvertKK- 4
.KK4 5
	ToBooleanKK5 >
(KK> ?
readerKK? E
[KKE F
$strKKF N
]KKN O
.KKO P
ToStringKKP X
(KKX Y
)KKY Z
)KKZ [
;KK[ \

validacionLL "
.LL" #
DetalleValidacionLL# 4
=LL5 6
incluirDetalleLL7 E
?LLF G$
ObtenerDetalleValidacionLLH `
(LL` a
idValidacionLLa m
)LLm n
:LLo p
nullLLq u
;LLu v
returnNN 

validacionNN )
;NN) *
}OO 
}PP 
returnRR 
nullRR 
;RR 
}SS 
}TT 	
public[[ 
List[[ 
<[[ 
DetalleValidacion[[ %
>[[% &$
ObtenerDetalleValidacion[[' ?
([[? @
int[[@ C
idValidacion[[D P
)[[P Q
{\\ 	
using]] 
(]] 
	DbCommand]] 
cmd]]  
=]]! "
Contexto]]# +
.]]+ , 
GetStoredProcCommand]], @
(]]@ A
$str]]A h
)]]h i
)]]i j
{^^ 
Contexto__ 
.__ 
AddInParameter__ '
(__' (
cmd__( +
,__+ ,
$str__- <
,__< =
DbType__> D
.__D E
Int32__E J
,__J K
idValidacion__L X
)__X Y
;__Y Z
varaa 
listadoaa 
=aa 
newaa !
Listaa" &
<aa& '
DetalleValidacionaa' 8
>aa8 9
(aa9 :
)aa: ;
;aa; <
usingcc 
(cc 
varcc 
readercc !
=cc" #
Contextocc$ ,
.cc, -
ExecuteReadercc- :
(cc: ;
cmdcc; >
)cc> ?
)cc? @
{dd 
whileee 
(ee 
readeree !
.ee! "
Readee" &
(ee& '
)ee' (
)ee( )
{ff 
vargg 
detallegg #
=gg$ %
newgg& )
DetalleValidaciongg* ;
(gg; <
)gg< =
;gg= >
detallehh 
.hh  
	IdDetallehh  )
=hh* +
Converthh, 3
.hh3 4
ToInt32hh4 ;
(hh; <
readerhh< B
[hhB C
$strhhC N
]hhN O
.hhO P
ToStringhhP X
(hhX Y
)hhY Z
)hhZ [
;hh[ \
detalleii 
.ii  
IdValidacionii  ,
=ii- .
Convertii/ 6
.ii6 7
ToInt32ii7 >
(ii> ?
readerii? E
[iiE F
$striiF T
]iiT U
.iiU V
ToStringiiV ^
(ii^ _
)ii_ `
)ii` a
;iia b
detallejj 
.jj  
Campojj  %
=jj& '
readerjj( .
[jj. /
$strjj/ 6
]jj6 7
.jj7 8
ToStringjj8 @
(jj@ A
)jjA B
;jjB C
detallekk 
.kk  
Operadorkk  (
=kk) *
readerkk+ 1
[kk1 2
$strkk2 <
]kk< =
.kk= >
ToStringkk> F
(kkF G
)kkG H
;kkH I
detallell 
.ll  
Valorll  %
=ll& '
readerll( .
[ll. /
$strll/ 6
]ll6 7
.ll7 8
ToStringll8 @
(ll@ A
)llA B
;llB C
listadonn 
.nn  
Addnn  #
(nn# $
detallenn$ +
)nn+ ,
;nn, -
}oo 
}pp 
returnrr 
listadorr 
;rr 
}ss 
}tt 	
public{{ 
bool{{ 
EjecutarValidacion{{ &
({{& '
int{{' *
idValidacion{{+ 7
){{7 8
{|| 	
using}} 
(}} 
	DbCommand}} 
cmd}}  
=}}! "
Contexto}}# +
.}}+ , 
GetStoredProcCommand}}, @
(}}@ A
$str}}A b
)}}b c
)}}c d
{~~ 
cmd 
. 
CommandTimeout "
=# $
$num% &
;& '
Contexto
── 
.
── 
AddInParameter
── '
(
──' (
cmd
──( +
,
──+ ,
$str
──- <
,
──< =
DbType
──> D
.
──D E
Int32
──E J
,
──J K
idValidacion
──L X
)
──X Y
;
──Y Z
return
┌┌ 
Contexto
┌┌ 
.
┌┌  
ExecuteNonQuery
┌┌  /
(
┌┌/ 0
cmd
┌┌0 3
)
┌┌3 4
>
┌┌5 6
$num
┌┌7 8
;
┌┌8 9
}
┐┐ 
}
└└ 	
}
┘┘ 
}├├ 